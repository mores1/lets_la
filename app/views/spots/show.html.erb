<h1 class="text-center font-weight-bolder"><%= @spot.title %>è©³ç´°</h1>
<h5 class="text-right font-weight-bolder">by <%= @spot.user.name %></h5>
<div id = "map"></div>
<%= image_tag @spot.get_image_id, size:"140x140", class:'card-img-show' %>
<%= @spot.body %>
ç·¯åº¦:<%= @spot.lat %><br>
çµŒåº¦:<%= @spot.lng %>
<%= link_to "ç·¨é›†", edit_spot_path(@spot), class: 'btn btn-success' %>
<%= link_to "å‰Šé™¤", spot_path(@spot), method: :delete, class: 'btn btn-danger' %>
<% if @spot.liked_by?(@current_user) %>
  <%= link_to spot_likes_path(@spot), method: :delete do %>
    <%= @spot.likes.count %>ğŸ’›
  <% end %>
<% else %>
  <%= link_to spot_likes_path(@spot), method: :post do %>
    <%= @spot.likes.count %>â™¡
  <% end %>
<% end %>
<div class="ml-4">
          ã‚³ãƒ¡ãƒ³ãƒˆ:<%= @spot.spot_comments.count %>ä»¶
        </div>
        <ul class="spot-comment">
          <% @spot.spot_comments.each do |spot_comment| %>
            <li>
              <%= spot_comment.comment %><br>
              <div class="text-right mr-2">
                <%= spot_comment.created_at.strftime('%Y/%m/%d') %>
                by <%= spot_comment.user.name %>
                <% if @spot_comment.user == @current_user || @current_user.name == "admin"  %>
                  <%= link_to "å‰Šé™¤", spot_spot_comment_path(spot_comment.spot, spot_comment), method: :delete %>
                <% end %>
              </div>
            </li>
          <% end %>
        </ul>
        <div class="ml-3">
        <!--% if current_user.name != "guestuser" %>-->
          <%= form_with model: [@spot, @spot_comment] do |f| %>
            <%= f.text_area :comment, placeholder: "ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" %>
            <%= f.submit "ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡" %>
          <% end %>
        <!--% end %>-->
      </div>
<style>
#map {
  height: 230px;
  width: 230px;
}
</style>

<script>
  function initMap() {
    //åˆæœŸè¡¨ç¤ºä½ç½®(ä¸­å¿ƒä½ç½®ã‚’ç™»éŒ²ãƒãƒ¼ã‚«ãƒ¼ã«å¤‰æ›´)
    let latlng = new google.maps.LatLng(<%= @spot.lat %>, <%= @spot.lng %>);
    //ãƒ‡ã‚¶ã‚¤ãƒ³
    let styles = [
         {
          stylers: [
           { "saturation": 0 },
           { "lightness": 0 }
          ]
         }
        ];
    let map = new google.maps.Map(document.getElementById('map'), {
        zoom: 15,
        styles: styles,
        center: latlng
    });
    let transitLayer = new google.maps.TransitLayer();
    transitLayer.setMap(map);
      ( function() {
        let markerLatLng = new google.maps.LatLng({lat: <%= @spot.lat %>, lng: <%= @spot.lng %>}); // ç·¯åº¦çµŒåº¦ã®ãƒ‡ãƒ¼ã‚¿ä½œæˆ
        let marker = new google.maps.Marker({
          position: markerLatLng,
          map: map
        });
  ã€€ã€€ã€€//ãƒãƒ¼ã‚«ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã€è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º
        let infowindow = new google.maps.InfoWindow({
          position: markerLatLng,
          content: "<a><%= @spot.title %></a>"
        }); //ã“ã“ã§è©³ç´°ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤ºã•ã›ã‚‹
        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });
     })();
  }
</script>