<h1 class="text-center font-weight-bolder"><%= @spot.title %>詳細</h1>
<h5 class="text-right font-weight-bolder">by <%= @spot.user.name %></h5>
<div id = "map"></div>
<%= image_tag @spot.get_image_id, size:"140x140", class:'card-img-show' %>
<%= @spot.body %>
緯度:<%= @spot.lat %><br>
経度:<%= @spot.lng %>
<%= link_to "編集", edit_spot_path(@spot), class: 'btn btn-success' %>
<%= link_to "削除", spot_path(@spot), method: :delete, class: 'btn btn-danger' %>

<style>
#map {
  height: 230px;
  width: 230px;
}
</style>

<script>
  function initMap() {
    //初期表示位置(中心位置を登録マーカーに変更)
    let latlng = new google.maps.LatLng(<%= @spot.lat %>, <%= @spot.lng %>);
    //デザイン
    let styles = [
         {
          stylers: [
           { "saturation": 0 },
           { "lightness": 0 }
          ]
         }
        ];
    let map = new google.maps.Map(document.getElementById('map'), {
        zoom: 15,
        styles: styles,
        center: latlng
    });
    let transitLayer = new google.maps.TransitLayer();
    transitLayer.setMap(map);
      ( function() {
        let markerLatLng = new google.maps.LatLng({lat: <%= @spot.lat %>, lng: <%= @spot.lng %>}); // 緯度経度のデータ作成
        let marker = new google.maps.Marker({
          position: markerLatLng,
          map: map
        });
  　　　//マーカーをクリックしたとき、詳細情報を表示
        let infowindow = new google.maps.InfoWindow({
          position: markerLatLng,
          content: "<a><%= @spot.title %></a>"
        }); //ここで詳細ページへのリンクを表示させる
        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });
     })();
  }
</script>
